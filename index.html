<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Decomposed  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>
    <a title="Decomposed  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Decomposed 0.0.5 Docs</a> (72% documented)</p>
        <p class="header-right">
          <form role="search" action="search.json">
            <input type="text" placeholder="Search documentation" data-typeahead>
          </form>
        </p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Decomposed Reference</a>
        <img id="carat" src="img/carat.png" />
        Decomposed  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Categories.html">Categories</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Categories/CALayer%28Decomposed%29.html">CALayer(Decomposed)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/DEDecomposedCATransform3D.html">DEDecomposedCATransform3D</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DEDecomposedCATransform3DProxy.html">DEDecomposedCATransform3DProxy</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DEDecomposedMatrixDouble4x4.html">DEDecomposedMatrixDouble4x4</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/DEDecomposedMatrixFloat4x4.html">DEDecomposedMatrixFloat4x4</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Constants.html">Constants</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Constants.html#/c:@DecomposedVersionNumber">DecomposedVersionNumber</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@DecomposedVersionString">DecomposedVersionString</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/CATransform3D.html">CATransform3D</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/CATransform3D/DecomposedTransform.html">– DecomposedTransform</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/SIMD2.html">SIMD2</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/SIMD3.html">SIMD3</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/SIMD4.html">SIMD4</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/matrix_double4x4.html">matrix_double4x4</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/matrix_double4x4/DecomposedTransform.html">– DecomposedTransform</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/matrix_float4x4.html">matrix_float4x4</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/matrix_float4x4/DecomposedTransform.html">– DecomposedTransform</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/simd_double3.html">simd_double3</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/simd_double4.html">simd_double4</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/simd_double4x4.html">simd_double4x4</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/simd_float3.html">simd_float3</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/simd_float4.html">simd_float4</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/simd_float4x4.html">simd_float4x4</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/simd_quatd.html">simd_quatd</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/simd_quatf.html">simd_quatf</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/Interpolatable.html">Interpolatable</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/CGQuaternion.html">CGQuaternion</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CGVector3.html">CGVector3</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/CGVector4.html">CGVector4</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:10Decomposed11Perspectivea">Perspective</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:10Decomposed5Scalea">Scale</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:10Decomposed4Skewa">Skew</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:10Decomposed11Translationa">Translation</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='decomposed' class='heading'>Decomposed</h1>

<p><img src="https://github.com/b3ll/Decomposed/workflows/Tests/badge.svg" alt="Tests">
<img src="https://github.com/b3ll/Decomposed/workflows/Docs/badge.svg" alt="Docs"></p>

<p>Manipulating and using <code>CATransform3D</code> for animations and interactions is pretty challenging… Decomposed makes <code>CATransform3D</code>, <code>matrix_double4x4</code>, and <code>matrix_float4x4</code> much easier to work with.</p>

<p align="center">
  <img width="240" height="519" src="https://github.com/b3ll/Decomposed/blob/main/Resources/Decomposed.gif?raw=true">
  <img width="240" height="519" src="https://github.com/b3ll/Decomposed/blob/main/Resources/Decomposed2.gif?raw=true">
</p>

<p><strong>Note</strong>: The API for Decomposed is still heavily being changed / optimized, so please feel free to give feedback and expect breaking changes as time moves on.</p>

<p>Specifically, I really want to figure out what to do about the Vector types introduced in this repository. If there are any issues with them please let me know; I&rsquo;m actively sourcing ways to make it better.</p>

<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#usage">Usage</a>

<ul>
<li><a href="#transform-modifications">Transform Modifications</a></li>
<li><a href="#calayer-extensions">CALayer Extensions</a></li>
<li><a href="#decomposedtransform">DecomposedTransform</a></li>
<li><a href="#cgvector3--cgvector4--cgquaternion">CGVector3 / CGVector4 / CGQuaternion</a></li>
<li><a href="#interpolatable">Interpolatable</a></li>
</ul></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#other-recommendations">Other Recommendations</a>

<ul>
<li><a href="#advance">Advance</a></li>
</ul></li>
<li><a href="#license">License</a></li>
<li><a href="#contact-info">Contact Info</a></li>
</ul>
<h1 id='introduction' class='heading'>Introduction</h1>

<p>Typically on iOS if you wanted to transform a <code>CALayer</code> you&rsquo;d do something like:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">layer</span><span class="p">:</span> <span class="kt">CAlayer</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">layer</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="kt">CATransform3DMakeScale</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</code></pre>

<p>However, what if you were given a transform from somewhere else? How would you know what the scale of the layer is? What if you wanted to set the scale or translation of a transform? Without lots of complex linear algebra, it&rsquo;s not easy to do!</p>

<p>Decomposed aims to simplify this by allowing for <code>CATransform3D</code>, <code>matrix_double4x4</code>, and <code>matrix_float4x4</code>, to be decomposed, recomposed, and mutated without complex math.</p>

<p>Decomposition is the act of breaking something down into smaller components, in this case transformation matrices into things like translation, scale, etc. in a way that they can all be individually changed or reset. The following are supported:</p>

<ul>
<li>Translation</li>
<li>Scale</li>
<li>Rotation (using Quaternions or Euler Angles)</li>
<li>Skew</li>
<li>Perspective</li>
</ul>

<p>It&rsquo;s also powered by Accelerate, so it should introduce relatively low overhead for matrix manipulations.</p>
<h1 id='usage' class='heading'>Usage</h1>

<p>API Documentation is <a href="https://b3ll.github.io/Decomposed/">here</a>.</p>
<h2 id='transform-modifications' class='heading'>Transform Modifications</h2>
<h3 id='swift' class='heading'>Swift</h3>

<p>Create a transform with a translation of 44pts on the Y-axis, rotated by .pi / 4.0 on the X-axis</p>
<pre class="highlight swift"><code><span class="k">var</span> <span class="nv">transform</span><span class="p">:</span> <span class="kt">CATransform3D</span> <span class="o">=</span> <span class="kt">CATransform3DIdentity</span>
  <span class="o">.</span><span class="nf">translatedBy</span><span class="p">(</span><span class="nv">y</span><span class="p">:</span> <span class="mf">44.0</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">rotatedBy</span><span class="p">(</span><span class="nv">angle</span><span class="p">:</span> <span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">,</span> <span class="nv">x</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>
</code></pre>
<h3 id='objective-c' class='heading'>Objective-C</h3>

<p>Create a transform with a translation of 44pts on the Y-axis, rotated by .pi / 40 on the X-axis.</p>
<pre class="highlight plaintext"><code>CATransform3DDecomposed *decomposed = [DEDecomposedCATransform3D decomposedTransformWithTransform:CATransform3DIdentity];
decomposed.translation = CGPoint(0.0, 44.0);
decomposed.rotation = simd_quaternion(M_PI / 4.0, simd_make_double3(1.0, 0.0, 0.0));
transform = [decomposed recompose];
</code></pre>
<h2 id='calayer-extensions' class='heading'>CALayer Extensions</h2>

<p>Typically when doing interactive gestures with <code>UIView</code> and <code>CALayer</code> you&rsquo;ll wind up dealing with implicit actions (animations) when changing transforms. Instead of wrapping your code in <code>CATransactions</code>&lsquo;s and disabling actions, Decomposed does this automatically for you.</p>
<h3 id='swift' class='heading'>Swift</h3>
<pre class="highlight swift"><code><span class="c1">// In some UIPanGestureRecognizer handling method</span>
<span class="n">layer</span><span class="o">.</span><span class="n">translation</span> <span class="o">=</span> <span class="n">panGestureRecognizer</span><span class="o">.</span><span class="nf">translation</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="kt">CGPoint</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">)</span>
</code></pre>
<h3 id='objective-c' class='heading'>Objective-C</h3>

<p>Since namespace collision happens in Objective-C, you&rsquo;re able to do similar changes via the <code>transformProxy</code> property. Changes to this proxy object will be applied to the layer&rsquo;s transform with implicit animations disabled.</p>
<pre class="highlight plaintext"><code>// In some UIPanGestureRecognizer handling method
layer.transformProxy.translation = [panGestureRecognizer translationInView:self];
layer.transformProxy.scale = CGPoint(x: 0.75, y: 0.75);
</code></pre>
<h2 id='decomposedtransform' class='heading'>DecomposedTransform</h2>

<p>Anytime you change a property on a <code>CATransform3D</code> or <code>matrix_double4x4</code>, it needs to be decomposed, changed, and then recomposed. This can be expensive if done a lot, so it should be limited. If you&rsquo;re making multiple changes at once, it&rsquo;s better to change the <code>DecomposedTransform</code> and then call its <code>recomposed()</code> function to get a recomposed transform.</p>
<h3 id='swift' class='heading'>Swift</h3>
<pre class="highlight swift"><code><span class="k">var</span> <span class="nv">decomposed</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="nf">decomposed</span><span class="p">()</span>
<span class="n">decomposed</span><span class="o">.</span><span class="n">translation</span> <span class="o">=</span> <span class="kt">Translation</span><span class="p">(</span><span class="mf">44.0</span><span class="p">,</span> <span class="mf">44.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">decomposed</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="kt">Scale</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">decomposed</span><span class="o">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="kt">CGQuaternion</span><span class="p">(</span><span class="nv">angle</span><span class="p">:</span> <span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">,</span> <span class="nv">axis</span><span class="p">:</span> <span class="kt">CGVector3</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>

<span class="k">let</span> <span class="nv">changedTransform</span> <span class="o">=</span> <span class="n">decomposed</span><span class="o">.</span><span class="nf">recomposed</span><span class="p">()</span>
</code></pre>
<h3 id='objective-c' class='heading'>Objective-C</h3>
<pre class="highlight plaintext"><code>DEDecomposedCATransform3D *decomposed = [DEDecomposedCATransform3D decomposedTransformWithTransform:transform];
decomposed.translation = CGPointMake(44.0, 44.0);
decomposed.scale = CGPointMake(0.75, 0.75);
decomposed.rotation = simd_quaternion(M_PI / 4.0, simd_make_double3(1.0, 0.0, 0.0));

CATransform3D changedTransform = [decomposed recomposed];
</code></pre>
<h2 id='cgvector3-cgvector4-cgquaternion' class='heading'>CGVector3 / CGVector4 / CGQuaternion</h2>

<p>Sadly, <code>simd</code> doesn&rsquo;t support storing <code>CGFloat</code> (even when they&rsquo;re <code>Double</code>). To make this library easier to use (i.e. without casting everything to doubles all the time <code>Double(some CGFloat)</code> you&rsquo;ll find <code><a href="Structs/CGVector3.html">CGVector3</a></code>, <code><a href="Structs/CGVector4.html">CGVector4</a></code>, and <code><a href="Structs/CGQuaternion.html">CGQuaternion</a></code>, which wrap <code>simd</code> counterparts: <code>simd_double3</code>, <code>simd_double4</code>, and <code>simd_quatd</code>, respectively.</p>

<p><code><a href="Typealiases.html#/s:10Decomposed11Translationa">Translation</a></code>, <code><a href="Typealiases.html#/s:10Decomposed5Scalea">Scale</a></code>, etc. are all type aliased (i.e. <code><a href="Structs/CGVector3.html">CGVector3</a></code> or <code><a href="Structs/CGVector4.html">CGVector4</a></code>), and they all conform to <code>ArrayLiteralRepresentable</code> so you can use <code>Array&lt;CGFloat&gt;</code> to initialize them.</p>
<pre class="highlight swift"><code><span class="n">layer</span><span class="o">.</span><span class="n">translation</span> <span class="o">=</span> <span class="kt">Translation</span><span class="p">(</span><span class="mf">44.0</span><span class="p">,</span> <span class="mf">44.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">layer</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="kt">Scale</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
</code></pre>

<p><strong>Note</strong>: This API is questionable in its current form as it collides with Swift&rsquo;s <code>Vector</code> types (which are just simd types and part of me thinks everything should be exposed as <code>simd</code> types), so I&rsquo;m happy to take feedback!</p>
<h2 id='interpolatable' class='heading'>Interpolatable</h2>

<p>It also provides functionality to linearly interpolate from any transform to any transform via the <code><a href="Protocols/Interpolatable.html">Interpolatable</a></code> protocol. This lets you easily animate / transition between transforms in a controlled manner.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">transform</span><span class="p">:</span> <span class="kt">CATransform3D</span> <span class="o">=</span> <span class="kt">CATransform3DIdentity</span>
  <span class="o">.</span><span class="nf">translatedBy</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="mf">44.0</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="mf">44.0</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">transform2</span> <span class="o">=</span> <span class="kt">CATransform3DIdentity</span>
  <span class="o">.</span><span class="nf">translatedBy</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="mf">120.0</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="mf">240.0</span><span class="p">)</span>
  <span class="o">.</span><span class="nf">scaled</span><span class="p">(</span><span class="nv">by</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
  <span class="o">.</span><span class="nf">rotatedBy</span><span class="p">(</span><span class="nv">angle</span><span class="p">:</span> <span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">4.0</span><span class="p">,</span> <span class="nv">x</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">interpolatedTransform</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="nf">lerp</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">transform2</span><span class="p">,</span> <span class="nv">fraction</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">)</span>
</code></pre>
<h1 id='installation' class='heading'>Installation</h1>
<h2 id='requirements' class='heading'>Requirements</h2>

<ul>
<li>iOS 13+, macOS 10.15+</li>
<li>Swift 5.0 or higher</li>
</ul>

<p>Currently Decomposed supports Swift Package Manager, CocoaPods, Carthage, being used as an xcframework, and being used manually as an Xcode subproject. Pull requests for other dependency systems / build systems are welcome!</p>
<h2 id='swift-package-manager' class='heading'>Swift Package Manager</h2>

<p>Add the following to your <code>Package.swift</code> (or add it via Xcode&rsquo;s GUI):</p>
<pre class="highlight swift"><code><span class="o">.</span><span class="nf">package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/b3ll/Decomposed"</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="s">"0.0.1"</span><span class="p">)</span>
</code></pre>
<h2 id='cocoapods' class='heading'>CocoaPods</h2>

<p>Add the following to your <code>Podfile</code>:</p>

<p><code>pod &#39;Decomposed&#39;</code></p>
<h2 id='xcframework' class='heading'>xcframework</h2>

<p>A built xcframework is available for each tagged release.</p>
<h4 id='notes' class='heading'>Notes</h4>

<p>For some reason, when using CocoaPods and the Objective-C parts of this library, you may see an error like:</p>

<p><code>Declaration of &#39;DEDecomposedCATransform3D&#39; must be imported from module &#39;Decomposed.Swift&#39; before it is required</code>.</p>

<p>To fix this, you&rsquo;ll need to use Objective-C++ files (i.e. rename from <code>.m</code> to <code>.mm</code>) or change your imports to:</p>
<pre class="highlight plaintext"><code>#import &lt;Decomposed/Decomposed.h&gt;
#import &lt;Decomposed/Decomposed-Swift.h&gt;
</code></pre>

<p>I don&rsquo;t have any other workarounds at the moment, but if I do, I&rsquo;ll make an update.</p>
<h2 id='carthage' class='heading'>Carthage</h2>

<p>Add the following to your <code>Cartfile</code>:</p>

<p><code>&quot;b3ll/Decomposed&quot;</code></p>
<h2 id='xcode-subproject' class='heading'>Xcode Subproject</h2>

<ul>
<li>Add <code>Decomposed.xcodeproj</code> to your project</li>
<li>Add <code>Decomposed.framework</code> as an embedded framework (it&rsquo;s a static library, so it should not be embedded).</li>
</ul>
<h4 id='objective-c-notes' class='heading'>Objective-C Notes</h4>

<ul>
<li>Objective-C support is <strong>not</strong> available through Swift Package Manager. Please use the manual Xcode subproject instead.</li>
<li>You&rsquo;ll want to use <code>#import &lt;Decomposed/Decomposed.h&gt;</code> as this contains both the generated Swift interfaces for the Objective-C classes and CALayer categories.</li>
<li>Not all of the API is available due to limitations of how Swift / Objective-C interop. Sadly the API can&rsquo;t be as nice, but <code>CATransform3DDecomposed</code> will allow for decomposition and recomposition of <code>CATransform3D</code> (similar classes exist for <code>matrix_double4x4</code> and <code>matrix_float4x4</code> and are wrappers around their Swift counterparts) as well as convenience categories on <code>CALayer</code>.</li>
</ul>
<h1 id='other-recommendations' class='heading'>Other Recommendations</h1>
<h2 id='motion' class='heading'>Motion</h2>

<p>This library pairs very nicely with <a href="https://github.com/b3ll/Motion">Motion</a>, an animation engine for gesturally-driven user interfaces, animations, and interactions on iOS, macOS, and tvOS.</p>

<p>Animating a layer on a spring by modifying its transform has never been easier! Usually you&rsquo;d have to manually wrap things in a <code>CATransaction</code> with actions disabled, and usage of <code>CATransform3DTranslate</code> gets pretty cumbersome.</p>

<p>With Decomposed + Motion this is super easy.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">layer</span> <span class="o">=</span> <span class="o">...</span>
<span class="k">let</span> <span class="nv">springAnimation</span> <span class="o">=</span> <span class="kt">SpringAnimation</span><span class="o">&lt;</span><span class="kt">CGPoint</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">initialValue</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
<span class="n">springAnimation</span><span class="o">.</span><span class="nf">onValueChanged</span><span class="p">(</span><span class="nv">disableActions</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span> <span class="p">[</span><span class="n">layer</span><span class="p">]</span> <span class="n">translation</span> <span class="k">in</span>
  <span class="n">layer</span><span class="o">.</span><span class="n">translation</span> <span class="o">=</span> <span class="n">translation</span>
<span class="p">}</span>

<span class="c1">// In your pan gesture recognizer callback</span>

<span class="k">let</span> <span class="nv">translation</span> <span class="o">=</span> <span class="n">panGestureRecognizer</span><span class="o">.</span><span class="nf">translation</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">velocity</span> <span class="o">=</span> <span class="n">panGestureRecognizer</span><span class="o">.</span><span class="nf">velocity</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="k">self</span><span class="o">.</span><span class="n">view</span><span class="p">)</span>

<span class="k">switch</span> <span class="n">panGestureRecognizer</span><span class="o">.</span><span class="n">state</span> <span class="p">{</span>
  <span class="k">case</span> <span class="o">.</span><span class="nv">began</span><span class="p">:</span>
    <span class="n">springAnimation</span><span class="o">.</span><span class="nf">stop</span><span class="p">()</span>
    <span class="n">springAnimation</span><span class="o">.</span><span class="nf">updateValue</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
  <span class="k">case</span> <span class="o">.</span><span class="nv">changed</span><span class="p">:</span>
    <span class="n">springAnimation</span><span class="o">.</span><span class="nf">updateValue</span><span class="p">(</span><span class="nv">to</span><span class="p">:</span> <span class="n">translation</span><span class="p">)</span>
    <span class="n">layer</span><span class="o">.</span><span class="n">translation</span> <span class="o">=</span> <span class="n">translation</span>
  <span class="k">case</span> <span class="o">.</span><span class="nv">ended</span><span class="p">:</span>
    <span class="n">springAnimation</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="n">velocity</span>
    <span class="n">springAnimation</span><span class="o">.</span><span class="n">toValue</span> <span class="o">=</span> <span class="kt">CGPoint</span><span class="p">(</span><span class="nv">x</span><span class="p">:</span> <span class="mf">200.0</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="mf">200.0</span><span class="p">)</span> <span class="c1">// wherever you want it to go</span>
    <span class="n">springAnimation</span><span class="o">.</span><span class="nf">start</span><span class="p">()</span>
  <span class="k">default</span><span class="p">:</span>
    <span class="k">break</span>
<span class="p">}</span>
</code></pre>

<p>See the DraggingCard demo for a good example of this :)</p>
<h1 id='license' class='heading'>License</h1>

<p>Decomposed is licensed under the <a href="https://github.com/b3ll/Decomposed/blob/main/LICENSE">BSD 2-clause license</a>.</p>
<h1 id='contact-info' class='heading'>Contact Info</h1>

<p>Feel free to follow me on twitter: <a href="https://www.twitter.com/b3ll">@b3ll</a>!</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2021 <a class="link" href="https://twitter.com/b3ll" target="_blank" rel="external">Adam Bell</a>. All rights reserved. (Last updated: 2021-03-07)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.6</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
